# Hugging Face + W&B  
é€šè¿‡æ— ç¼çš„ [W&B](https://wandb.ai/site) é›†æˆï¼Œå¿«é€Ÿå¯è§†åŒ–ä½ çš„ [Hugging Face](https://github.com/huggingface/transformers) æ¨¡å‹æ€§èƒ½ã€‚  
æ¯”è¾ƒè¶…å‚æ•°ã€è¾“å‡ºæŒ‡æ ‡ä»¥åŠç³»ç»Ÿç»Ÿè®¡æ•°æ®ï¼Œå¦‚ GPU åˆ©ç”¨ç‡ã€‚

<img src="https://i.imgur.com/vnejHGh.png" width="800">  

## ğŸ¤” ä¸ºä»€ä¹ˆæˆ‘åº”è¯¥ä½¿ç”¨ W&Bï¼Ÿ  

<img src="https://wandb.me/mini-diagram" width="650">  

- **ç»Ÿä¸€ä»ªè¡¨ç›˜**ï¼šæ‰€æœ‰æ¨¡å‹æŒ‡æ ‡å’Œé¢„æµ‹çš„ä¸­å¤®å­˜å‚¨åº“  
- **è½»é‡çº§**ï¼šæ— éœ€ä»£ç æ›´æ”¹å³å¯ä¸ Hugging Face é›†æˆ  
- **å¯è®¿é—®**ï¼šä¸ªäººå’Œå­¦æœ¯å›¢é˜Ÿå…è´¹ä½¿ç”¨  
- **å®‰å…¨**ï¼šæ‰€æœ‰é¡¹ç›®é»˜è®¤ç§æœ‰  
- **å¯ä¿¡**ï¼šè¢« OpenAIã€Toyotaã€Lyft ç­‰æœºå™¨å­¦ä¹ å›¢é˜Ÿä½¿ç”¨  

å°† W&B è§†ä¸ºæœºå™¨å­¦ä¹ æ¨¡å‹çš„ GitHubâ€”â€”å°†æœºå™¨å­¦ä¹ å®éªŒä¿å­˜åˆ°ä½ çš„ç§æœ‰æ‰˜ç®¡ä»ªè¡¨ç›˜ã€‚å¿«é€Ÿå®éªŒï¼Œç¡®ä¿æ‰€æœ‰æ¨¡å‹ç‰ˆæœ¬éƒ½å·²ä¿å­˜ï¼Œæ— è®ºä½ åœ¨å“ªé‡Œè¿è¡Œè„šæœ¬ã€‚  
W&B çš„è½»é‡çº§é›†æˆé€‚ç”¨äºä»»ä½• Python è„šæœ¬ï¼Œä½ åªéœ€æ³¨å†Œä¸€ä¸ªå…è´¹çš„ W&B è´¦æˆ·å³å¯å¼€å§‹è·Ÿè¸ªå’Œå¯è§†åŒ–ä½ çš„æ¨¡å‹ã€‚

åœ¨ Hugging Face Transformers ä»“åº“ä¸­ï¼Œæˆ‘ä»¬å·²å°† Trainer é…ç½®ä¸ºåœ¨æ¯ä¸ªæ—¥å¿—æ­¥éª¤è‡ªåŠ¨å°†è®­ç»ƒå’Œè¯„ä¼°æŒ‡æ ‡è®°å½•åˆ° W&Bã€‚  
ä»¥ä¸‹æ˜¯é›†æˆå·¥ä½œåŸç†çš„æ·±å…¥åˆ†æï¼š[Hugging Face + W&B æŠ¥å‘Š](https://app.wandb.ai/jxmorris12/huggingface-demo/reports/Train-a-model-with-Hugging-Face-and-Weights-%26-Biases--VmlldzoxMDE2MTU)ã€‚

# ğŸš€ å®‰è£…ã€å¯¼å…¥å’Œç™»å½•  

å®‰è£… Hugging Face å’Œ Weights & Biases åº“ï¼Œä»¥åŠæœ¬æ•™ç¨‹çš„ GLUE æ•°æ®é›†å’Œè®­ç»ƒè„šæœ¬ã€‚  
- [Hugging Face Transformers](https://github.com/huggingface/transformers)ï¼šè‡ªç„¶è¯­è¨€æ¨¡å‹å’Œæ•°æ®é›†  
- [Weights & Biases](https://docs.wandb.com/)ï¼šå®éªŒè·Ÿè¸ªå’Œå¯è§†åŒ–  
- [GLUE æ•°æ®é›†](https://gluebenchmark.com/)ï¼šè¯­è¨€ç†è§£åŸºå‡†æ•°æ®é›†  
- [GLUE è„šæœ¬](https://github.com/huggingface/transformers/blob/master/examples/run_glue.py)ï¼šç”¨äºåºåˆ—åˆ†ç±»çš„æ¨¡å‹è®­ç»ƒè„šæœ¬  

```python
!pip install datasets wandb evaluate accelerate -qU
!wget https://raw.githubusercontent.com/huggingface/transformers/master/examples/pytorch/text-classification/run_glue.py
```

```python
# run_glue.py è„šæœ¬éœ€è¦ transformers dev ç‰ˆæœ¬
!pip install -q git+https://github.com/huggingface/transformers
```

## ğŸ–Šï¸ [æ³¨å†Œå…è´¹è´¦æˆ· â†’](https://app.wandb.ai/login?signup=true)  



## ğŸ”‘ è¾“å…¥ä½ çš„ API å¯†é’¥  
æ³¨å†Œåï¼Œè¿è¡Œä¸‹ä¸€ä¸ªå•å…ƒæ ¼å¹¶ç‚¹å‡»é“¾æ¥è·å–ä½ çš„ API å¯†é’¥ä»¥éªŒè¯æ­¤ç¬”è®°æœ¬ã€‚

```python
import wandb
```

```python
wandb.login()
```

å¯é€‰åœ°ï¼Œæˆ‘ä»¬å¯ä»¥è®¾ç½®ç¯å¢ƒå˜é‡ä»¥è‡ªå®šä¹‰ W&B æ—¥å¿—è®°å½•ã€‚æŸ¥çœ‹ [æ–‡æ¡£](https://docs.wandb.com/library/integrations/huggingface)ã€‚

```python
# å¯é€‰ï¼šè®°å½•æ¢¯åº¦å’Œå‚æ•°
%env WANDB_WATCH=all
```

# ğŸ‘Ÿ è®­ç»ƒæ¨¡å‹  
æ¥ä¸‹æ¥ï¼Œè°ƒç”¨ä¸‹è½½çš„è®­ç»ƒè„šæœ¬ [run_glue.py](https://huggingface.co/transformers/examples.html#glue)ï¼Œå¹¶æŸ¥çœ‹è®­ç»ƒè‡ªåŠ¨è·Ÿè¸ªåˆ° Weights & Biases ä»ªè¡¨ç›˜ã€‚è¯¥è„šæœ¬åœ¨ Microsoft Research Paraphrase Corpus ä¸Šå¾®è°ƒ BERTâ€”â€”åŒ…å«äººç±»æ ‡æ³¨çš„å¥å­å¯¹ï¼ŒæŒ‡ç¤ºå®ƒä»¬æ˜¯å¦è¯­ä¹‰ç­‰ä»·ã€‚

```python
%env WANDB_PROJECT=huggingface-demo
%env TASK_NAME=MRPC

!python run_glue.py \
  --model_name_or_path bert-base-uncased \
  --task_name $TASK_NAME \
  --do_train \
  --do_eval \
  --max_seq_length 256 \
  --per_device_train_batch_size 32 \
  --learning_rate 2e-4 \
  --num_train_epochs 3 \
  --output_dir /tmp/$TASK_NAME/ \
  --overwrite_output_dir \
  --logging_steps 50
```

# ğŸ‘€ åœ¨ä»ªè¡¨ç›˜ä¸­å¯è§†åŒ–ç»“æœ  
ç‚¹å‡»ä¸Šé¢æ‰“å°çš„é“¾æ¥ï¼Œæˆ–è®¿é—® [wandb.ai](https://app.wandb.ai) æŸ¥çœ‹ä½ çš„ç»“æœå®æ—¶æµå…¥ã€‚æµè§ˆå™¨ä¸­æŸ¥çœ‹ä½ çš„è¿è¡Œçš„é“¾æ¥å°†åœ¨æ‰€æœ‰ä¾èµ–é¡¹åŠ è½½åå‡ºç°â€”â€”æŸ¥æ‰¾ä»¥ä¸‹è¾“å‡ºï¼šâ€œ**wandb**: ğŸš€ View run at [URL to your unique run]â€  

**å¯è§†åŒ–æ¨¡å‹æ€§èƒ½**  è½»æ¾æŸ¥çœ‹æ•°åä¸ªå®éªŒï¼Œæ”¾å¤§æœ‰è¶£çš„å‘ç°ï¼Œå¹¶å¯è§†åŒ–é«˜ç»´æ•°æ®ã€‚  
![](https://docs.wandb.ai/images/tutorials/huggingface-visualize.gif)  

**æ¯”è¾ƒæ¶æ„**  è¿™æ˜¯ä¸€ä¸ªæ¯”è¾ƒ [BERT vs DistilBERT](https://app.wandb.ai/jack-morris/david-vs-goliath/reports/Does-model-size-matter%3F-Comparing-BERT-and-DistilBERT-using-Sweeps--VmlldzoxMDUxNzU) çš„ç¤ºä¾‹â€”â€”é€šè¿‡è‡ªåŠ¨æŠ˜çº¿å›¾å¯è§†åŒ–ï¼Œå¯ä»¥è½»æ¾æŸ¥çœ‹ä¸åŒæ¶æ„å¦‚ä½•å½±å“è®­ç»ƒæœŸé—´çš„è¯„ä¼°å‡†ç¡®æ€§ã€‚  
![](https://docs.wandb.ai/images/tutorials/huggingface-comparearchitectures.gif)  

### ğŸ“ˆ é»˜è®¤æƒ…å†µä¸‹è½»æ¾è·Ÿè¸ªå…³é”®ä¿¡æ¯  
Weights & Biases ä¸ºæ¯ä¸ªå®éªŒä¿å­˜ä¸€ä¸ªæ–°çš„è¿è¡Œã€‚ä»¥ä¸‹æ˜¯é»˜è®¤ä¿å­˜çš„ä¿¡æ¯ï¼š  
- **è¶…å‚æ•°**ï¼šæ¨¡å‹è®¾ç½®ä¿å­˜åœ¨ Config ä¸­  
- **æ¨¡å‹æŒ‡æ ‡**ï¼šæµå¼ä¼ è¾“çš„æŒ‡æ ‡æ—¶é—´åºåˆ—æ•°æ®ä¿å­˜åœ¨ Log ä¸­  
- **ç»ˆç«¯æ—¥å¿—**ï¼šå‘½ä»¤è¡Œè¾“å‡ºä¿å­˜åœ¨é€‰é¡¹å¡ä¸­  
- **ç³»ç»ŸæŒ‡æ ‡**ï¼šGPU å’Œ CPU åˆ©ç”¨ç‡ã€å†…å­˜ã€æ¸©åº¦ç­‰  

## ğŸ¤“ äº†è§£æ›´å¤šï¼  
- [æ–‡æ¡£](https://docs.wandb.com/huggingface)ï¼šWeights & Biases å’Œ Hugging Face é›†æˆçš„æ–‡æ¡£  
- [è§†é¢‘](http://wandb.me/youtube)ï¼šæ•™ç¨‹ã€ä¸ä»ä¸šè€…çš„è®¿è°ˆç­‰ï¼Œè¯·è®¿é—®æˆ‘ä»¬çš„ YouTube é¢‘é“  
- è”ç³»æˆ‘ä»¬ï¼šå¦‚æœ‰é—®é¢˜ï¼Œè¯·å‘é€é‚®ä»¶è‡³ contact@wandb.com